<html lang="ja">

<head>
  <meta name="robots" content="noindex">
  <meta name="robots" content="nofolllow">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>„É´„Éº„Éì„ÉÉ„ÇØ„Ç∑„É£„ÉÉ„Éï„É´</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #e0f2fe 0%, #f3e8ff 100%);
      min-height: 100vh;
      padding: 2rem;
    }

    .container {
      max-width: 1000px;
      margin: 0 auto;
    }

    h1 {
      text-align: center;
      color: #1f2937;
      font-size: 2.5rem;
      margin-bottom: 2rem;
    }

    .card {
      background: white;
      border-radius: 0.5rem;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      padding: 1.5rem;
      margin-bottom: 1.5rem;
    }

    .btn {
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 0.5rem;
      font-size: 1rem;
      font-weight: bold;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      transition: opacity 0.2s;
      user-select: none;
    }

    .btn:hover {
      opacity: 0.9;
    }

    .btn-blue {
      background: #2563eb;
      color: white;
    }

    .btn-red {
      background: #dc2626;
      color: white;
    }

    .btn-green {
      background: #16a34a;
      color: white;
    }

    .btn-gray {
      background: #4b5563;
      color: white;
    }

    .btn-full {
      width: 100%;
      justify-content: center;
    }

    .scramble-text {
      font-family: 'Courier New', monospace;
      font-size: 1.125rem;
      background: #f3f4f6;
      padding: 1rem;
      border-radius: 0.25rem;
      word-wrap: break-word;
    }

    .timer-display {
      font-family: 'Courier New', monospace;
      font-size: 3rem;
      text-align: center;
      margin: 1rem 0;
      color: #1f2937;
    }

    .button-group {
      display: flex;
      gap: 1rem;
      justify-content: center;
    }

    .cube-net {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.5rem;
    }

    .cube-row {
      display: flex;
      gap: 0.5rem;
    }

    .cube-face {
      display: inline-block;
    }

    .face-label {
      text-align: center;
      font-size: 0.75rem;
      font-weight: bold;
      margin-bottom: 0.25rem;
    }

    .face-grid {
      display: grid;
      grid-template-columns: repeat(3, 32px);
      gap: 2px;
      background: black;
      padding: 4px;
    }

    .sticker {
      width: 32px;
      height: 32px;
      border: 1px solid #374151;
    }

    h2 {
      font-size: 1.25rem;
      font-weight: bold;
      margin-bottom: 1rem;
      color: #1f2937;
      text-align: center;
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>„É´„Éº„Éì„ÉÉ„ÇØ„Ç∑„É£„ÉÉ„Éï„É´</h1>

    <div class="card">
      <button class="btn btn-blue btn-full" onclick="generateScramble()">
        üîÑ Êñ∞„Åó„ÅÑ„Çπ„ÇØ„É©„É≥„Éñ„É´
      </button>
    </div>

    <div id="scrambleCard" class="card" style="display: none;">
      <h2>„Çπ„ÇØ„É©„É≥„Éñ„É´:</h2>
      <div id="scrambleText" class="scramble-text"></div>
    </div>

    <div id="cubeCard" class="card" style="display: none;">
      <h2>„Ç≠„É•„Éº„ÉñÂ±ïÈñãÂõ≥</h2>
      <div id="cubeNet" class="cube-net"></div>
    </div>

    <div class="card">
      <h2>„Çø„Ç§„Éû„Éº</h2>
      <div id="timerDisplay" class="timer-display">0:00.00</div>
      <div class="button-group">
        <button id="startBtn" class="btn btn-blue" onmousedown="handleStartPress()" onmouseup="handleStartRelease()"
          onmouseleave="handleStartCancel()" ontouchstart="handleStartPress(event)"
          ontouchend="handleStartRelease(event)">
          ‚ñ∂ ÈñãÂßã (Êäº„Åó„Å¶Èõ¢„Åô)
        </button>
        <button id="stopBtn" class="btn btn-green" style="display: none;" onclick="stopTimer()">
          ‚è∏ ÂÅúÊ≠¢
        </button>
        <button class="btn btn-gray" onclick="resetTimer()">
          ‚Üª „É™„Çª„ÉÉ„Éà
        </button>
      </div>
    </div>
  </div>

  <script>
    let cube = null;
    let time = 0;
    let isRunning = false;
    let isPressed = false;
    let timerInterval = null;

    const colorMap = {
      W: '#FFFFFF',
      Y: '#FFFF00',
      G: '#00D000',
      B: '#0000FF',
      R: '#FF0000',
      O: '#FF8800'
    };

    function initCube() {
      // Ê®ôÊ∫ñÈÖçËâ≤: U(ÁôΩ) D(ÈªÑ) F(Á∑ë) B(Èùí) R(Ëµ§) L(Ê©ô)
      return {
        U: Array(9).fill('W'),
        D: Array(9).fill('Y'),
        F: Array(9).fill('G'),
        B: Array(9).fill('B'),
        R: Array(9).fill('R'),
        L: Array(9).fill('O')
      };
    }

    // Èù¢„ÅÆÊôÇË®àÂõû„ÇäÂõûËª¢Ôºà„Åù„ÅÆÈù¢„ÇíÊ≠£Èù¢„Åã„ÇâË¶ã„Å¶Ôºâ
    function rotateFaceCW(face) {
      return [face[6], face[3], face[0], face[7], face[4], face[1], face[8], face[5], face[2]];
    }

    // Èù¢„ÅÆÂèçÊôÇË®àÂõû„ÇäÂõûËª¢Ôºà„Åù„ÅÆÈù¢„ÇíÊ≠£Èù¢„Åã„ÇâË¶ã„Å¶Ôºâ
    function rotateFaceCCW(face) {
      return [face[2], face[5], face[8], face[1], face[4], face[7], face[0], face[3], face[6]];
    }

    function applyMove(state, move) {
      const c = JSON.parse(JSON.stringify(state));

      // 2ÂõûËª¢„ÅÆÂá¶ÁêÜ
      if (move.endsWith('2')) {
        const baseMove = move.slice(0, -1);
        let temp = applyMove(state, baseMove);
        return applyMove(temp, baseMove);
      }

      const isPrime = move.endsWith("'");
      const face = move[0];

      if (face === 'U') {
        if (isPrime) {
          c.U = rotateFaceCCW(c.U);
          const t = [c.F[0], c.F[1], c.F[2]];
          [c.F[0], c.F[1], c.F[2]] = [c.L[0], c.L[1], c.L[2]];
          [c.L[0], c.L[1], c.L[2]] = [c.B[0], c.B[1], c.B[2]];
          [c.B[0], c.B[1], c.B[2]] = [c.R[0], c.R[1], c.R[2]];
          [c.R[0], c.R[1], c.R[2]] = t;
        } else {
          c.U = rotateFaceCW(c.U);
          const t = [c.F[0], c.F[1], c.F[2]];
          [c.F[0], c.F[1], c.F[2]] = [c.R[0], c.R[1], c.R[2]];
          [c.R[0], c.R[1], c.R[2]] = [c.B[0], c.B[1], c.B[2]];
          [c.B[0], c.B[1], c.B[2]] = [c.L[0], c.L[1], c.L[2]];
          [c.L[0], c.L[1], c.L[2]] = t;
        }
      } else if (face === 'D') {
        if (isPrime) {
          c.D = rotateFaceCCW(c.D);
          const t = [c.F[6], c.F[7], c.F[8]];
          [c.F[6], c.F[7], c.F[8]] = [c.R[6], c.R[7], c.R[8]];
          [c.R[6], c.R[7], c.R[8]] = [c.B[6], c.B[7], c.B[8]];
          [c.B[6], c.B[7], c.B[8]] = [c.L[6], c.L[7], c.L[8]];
          [c.L[6], c.L[7], c.L[8]] = t;
        } else {
          c.D = rotateFaceCW(c.D);
          const t = [c.F[6], c.F[7], c.F[8]];
          [c.F[6], c.F[7], c.F[8]] = [c.L[6], c.L[7], c.L[8]];
          [c.L[6], c.L[7], c.L[8]] = [c.B[6], c.B[7], c.B[8]];
          [c.B[6], c.B[7], c.B[8]] = [c.R[6], c.R[7], c.R[8]];
          [c.R[6], c.R[7], c.R[8]] = t;
        }
      } else if (face === 'F') {
        if (isPrime) {
          c.F = rotateFaceCCW(c.F);
          const t = [c.U[6], c.U[7], c.U[8]];
          [c.U[6], c.U[7], c.U[8]] = [c.R[0], c.R[3], c.R[6]];
          [c.R[0], c.R[3], c.R[6]] = [c.D[2], c.D[1], c.D[0]];
          [c.D[0], c.D[1], c.D[2]] = [c.L[2], c.L[5], c.L[8]];
          [c.L[2], c.L[5], c.L[8]] = [c.U[8], c.U[7], c.U[6]];
        } else {
          c.F = rotateFaceCW(c.F);
          const t = [c.U[6], c.U[7], c.U[8]];
          [c.U[6], c.U[7], c.U[8]] = [c.L[8], c.L[5], c.L[2]];
          [c.L[2], c.L[5], c.L[8]] = [c.D[0], c.D[1], c.D[2]];
          [c.D[0], c.D[1], c.D[2]] = [c.R[6], c.R[3], c.R[0]];
          [c.R[0], c.R[3], c.R[6]] = [t[0], t[1], t[2]];
        }
      } else if (face === 'B') {
        if (isPrime) {
          c.B = rotateFaceCCW(c.B);
          const t = [c.U[0], c.U[1], c.U[2]];
          [c.U[0], c.U[1], c.U[2]] = [c.L[6], c.L[3], c.L[0]];
          [c.L[0], c.L[3], c.L[6]] = [c.D[6], c.D[7], c.D[8]];
          [c.D[6], c.D[7], c.D[8]] = [c.R[8], c.R[5], c.R[2]];
          [c.R[2], c.R[5], c.R[8]] = [t[0], t[1], t[2]];
        } else {
          c.B = rotateFaceCW(c.B);
          const t = [c.U[0], c.U[1], c.U[2]];
          [c.U[0], c.U[1], c.U[2]] = [c.R[2], c.R[5], c.R[8]];
          [c.R[2], c.R[5], c.R[8]] = [c.D[8], c.D[7], c.D[6]];
          [c.D[6], c.D[7], c.D[8]] = [c.L[0], c.L[3], c.L[6]];
          [c.L[0], c.L[3], c.L[6]] = [t[2], t[1], t[0]];
        }
      } else if (face === 'R') {
        if (isPrime) {
          c.R = rotateFaceCCW(c.R);
          const t = [c.F[2], c.F[5], c.F[8]];
          [c.F[2], c.F[5], c.F[8]] = [c.U[2], c.U[5], c.U[8]];
          [c.U[2], c.U[5], c.U[8]] = [c.B[6], c.B[3], c.B[0]];
          [c.B[0], c.B[3], c.B[6]] = [c.D[8], c.D[5], c.D[2]];
          [c.D[2], c.D[5], c.D[8]] = t;
        } else {
          c.R = rotateFaceCW(c.R);
          const t = [c.F[2], c.F[5], c.F[8]];
          [c.F[2], c.F[5], c.F[8]] = [c.D[2], c.D[5], c.D[8]];
          [c.D[2], c.D[5], c.D[8]] = [c.B[6], c.B[3], c.B[0]];
          [c.B[0], c.B[3], c.B[6]] = [c.U[8], c.U[5], c.U[2]];
          [c.U[2], c.U[5], c.U[8]] = t;
        }
      } else if (face === 'L') {
        if (isPrime) {
          c.L = rotateFaceCCW(c.L);
          const t = [c.F[0], c.F[3], c.F[6]];
          [c.F[0], c.F[3], c.F[6]] = [c.D[0], c.D[3], c.D[6]];
          [c.D[0], c.D[3], c.D[6]] = [c.B[8], c.B[5], c.B[2]];
          [c.B[2], c.B[5], c.B[8]] = [c.U[6], c.U[3], c.U[0]];
          [c.U[0], c.U[3], c.U[6]] = t;
        } else {
          c.L = rotateFaceCW(c.L);
          const t = [c.F[0], c.F[3], c.F[6]];
          [c.F[0], c.F[3], c.F[6]] = [c.U[0], c.U[3], c.U[6]];
          [c.U[0], c.U[3], c.U[6]] = [c.B[8], c.B[5], c.B[2]];
          [c.B[2], c.B[5], c.B[8]] = [c.D[6], c.D[3], c.D[0]];
          [c.D[0], c.D[3], c.D[6]] = t;
        }
      }

      return c;
    }

    function generateScramble() {
      const moves = ['U', "U'", 'U2', 'D', "D'", 'D2', 'F', "F'", 'F2', 'B', "B'", 'B2', 'R', "R'", 'R2', 'L', "L'", 'L2'];
      const scrambleMoves = [];
      let lastFace = '';

      for (let i = 0; i < 20; i++) {
        let move;
        do {
          move = moves[Math.floor(Math.random() * moves.length)];
        } while (move[0] === lastFace);

        scrambleMoves.push(move);
        lastFace = move[0];
      }

      const scrambleStr = scrambleMoves.join(' ');
      document.getElementById('scrambleText').textContent = scrambleStr;
      document.getElementById('scrambleCard').style.display = 'block';

      cube = initCube();
      scrambleMoves.forEach(move => {
        cube = applyMove(cube, move);
      });

      renderCube();
      document.getElementById('cubeCard').style.display = 'block';

      resetTimer();
    }

    function renderFace(face, label) {
      const faceDiv = document.createElement('div');
      faceDiv.className = 'cube-face';

      const labelDiv = document.createElement('div');
      labelDiv.className = 'face-label';
      labelDiv.textContent = label;
      faceDiv.appendChild(labelDiv);

      const gridDiv = document.createElement('div');
      gridDiv.className = 'face-grid';

      face.forEach(color => {
        const sticker = document.createElement('div');
        sticker.className = 'sticker';
        sticker.style.backgroundColor = colorMap[color];
        gridDiv.appendChild(sticker);
      });

      faceDiv.appendChild(gridDiv);
      return faceDiv;
    }

    // ÂæåÈù¢„Çí‰∏ã„Å´Ë°®Á§∫„Åô„Çã„Éê„Éº„Ç∏„Éß„É≥
    function renderCube() {
      const cubeNet = document.getElementById('cubeNet');
      cubeNet.innerHTML = '';

      // 1. ‰∏äÈù¢(U)
      cubeNet.appendChild(renderFace(cube.U, '‰∏ä(U)'));

      // 2. ‰∏≠ÈñìË°å: Â∑¶(L) - Ââç(F) - Âè≥(R)
      const middleRow = document.createElement('div');
      middleRow.className = 'cube-row';
      middleRow.appendChild(renderFace(cube.L, 'Â∑¶(L)'));
      middleRow.appendChild(renderFace(cube.F, 'Ââç(F)'));
      middleRow.appendChild(renderFace(cube.R, 'Âè≥(R)'));
      cubeNet.appendChild(middleRow);

      // 3. ‰∏ãÈù¢(D)
      cubeNet.appendChild(renderFace(cube.D, '‰∏ã(D)'));

      // 4. BÈù¢(F„ÅÆ‰∏ã„Å´ÂçòÁã¨„ÅßÈÖçÁΩÆ)
      const backRow = document.createElement('div');
      backRow.className = 'cube-row';
      backRow.appendChild(document.createElement('div')); // „Çπ„Éö„Éº„Çπ
      backRow.appendChild(renderFace(cube.B, 'Âæå(B)'));
      cubeNet.appendChild(backRow);
    }

    function formatTime(ms) {
      const minutes = Math.floor(ms / 60000);
      const seconds = Math.floor((ms % 60000) / 1000);
      const centiseconds = Math.floor((ms % 1000) / 10);
      const secStr = seconds < 10 ? '0' + seconds : seconds.toString();
      const csStr = centiseconds < 10 ? '0' + centiseconds : centiseconds.toString();
      return minutes + ':' + secStr + '.' + csStr;
    }

    function updateTimerDisplay() {
      document.getElementById('timerDisplay').textContent = formatTime(time);
    }

    function handleStartPress(event) {
      if (event) event.preventDefault();
      isPressed = true;
      const btn = document.getElementById('startBtn');
      btn.className = 'btn btn-red';
      btn.textContent = '‚ñ∂ Èõ¢„Åó„Å¶„Çπ„Çø„Éº„Éà';
    }

    function handleStartRelease(event) {
      if (event) event.preventDefault();
      if (!isPressed) return;

      isPressed = false;
      time = 0;
      updateTimerDisplay();

      document.getElementById('startBtn').style.display = 'none';
      document.getElementById('stopBtn').style.display = 'inline-flex';

      isRunning = true;
      timerInterval = setInterval(() => {
        time += 10;
        updateTimerDisplay();
      }, 10);
    }

    function handleStartCancel() {
      if (isPressed) {
        isPressed = false;
        const btn = document.getElementById('startBtn');
        btn.className = 'btn btn-blue';
        btn.textContent = '‚ñ∂ ÈñãÂßã (Êäº„Åó„Å¶Èõ¢„Åô)';
      }
    }

    function stopTimer() {
      isRunning = false;
      if (timerInterval) {
        clearInterval(timerInterval);
        timerInterval = null;
      }

      document.getElementById('stopBtn').style.display = 'none';
      const startBtn = document.getElementById('startBtn');
      startBtn.style.display = 'inline-flex';
      startBtn.className = 'btn btn-blue';
      startBtn.textContent = '‚ñ∂ ÈñãÂßã (Êäº„Åó„Å¶Èõ¢„Åô)';
    }

    function resetTimer() {
      stopTimer();
      time = 0;
      updateTimerDisplay();
      isPressed = false;
    }
  </script>
</body>

</html>